[
  {
    "description": "3 requests in 3s",
    "global": false,
    "exclude": [],
    "id": "limitcountry",
    "include": [],
    "key": [
      {
        "attrs": "country"
      }
    ],
    "name": "Rate Limit Example Rule 3/3",
    "pairwith": {
      "self": "self"
    },
    "thresholds": [
      {
        "action": "default",
        "limit": 3
      }
    ],
    "timeframe": 3
  },
  {
    "description": "3 requests in 3s",
    "global": false,
    "exclude": [],
    "id": "limitsimple",
    "include": [],
    "key": [
      {
        "attrs": "ip"
      }
    ],
    "name": "Rate Limit Example Rule 3/3",
    "pairwith": {
      "self": "self"
    },
    "thresholds": [
      {
        "action": "default",
        "limit": "3"
      }
    ],
    "timeframe": 3
  },
  {
    "description": "3 requests in 3s",
    "global": false,
    "exclude": [],
    "id": "limitinclude",
    "include": [
      "hdrfoobar"
    ],
    "key": [
      {
        "attrs": "ip"
      }
    ],
    "name": "Rate Limit Example Rule 3/3",
    "pairwith": {
      "self": "self"
    },
    "thresholds": [
      {
        "action": "default",
        "limit": 3
      }
    ],
    "timeframe": 3
  },
  {
    "description": "3 requests in 3s",
    "exclude": [
      "hdrfoobar"
    "global": false,
  ],
    "id": "limitexclude",
    "include": [],
    "key": [
      {
        "attrs": "ip"
      }
    ],
    "name": "Rate Limit Example Rule 3/3",
    "pairwith": {
      "self": "self"
    },
    "thresholds": [
      {
        "action": "default",
        "limit": 3
      }
    ],
    "timeframe": 3
  },
  {
    "description": "3 requests in 3s",
    "global": false,
    "exclude": [],
    "id": "includecompany",
    "include": [
      "asn:CLOUDFARE",
      "authority:foo"
    ],
    "key": [
      {
        "attrs": "ip"
      }
    ],
    "name": "Rate Limit Example with company",
    "pairwith": {
      "self": "self"
    },
    "thresholds": [
      {
        "action": "d5vnu3hs",
        "limit": 3
      }
    ],
    "timeframe": 3
  },
  {
    "description": "3 requests in 3s",
    "global": false,
    "exclude": [],
    "id": "redirector",
    "include": [],
    "key": [
      {
        "attrs": "ip"
      }
    ],
    "name": "Rate Limit redirection",
    "pairwith": {
      "self": "self"
    },
    "thresholds": [
      {
        "action": "sk9lz9q4",
        "limit": 3
      }
    ],
    "timeframe": 3
  },
  {
    "description": "3 requests per 10 seconds",
    "global": false,
    "exclude": [],
    "id": "e2e1000000007",
    "include": [
      "geo-country:united-states"
    ],
    "key": [
      {
        "attrs": "ip"
      }
    ],
    "name": "Rate Limit Rule 3/10 scope-country-include",
    "pairwith": {
      "self": "self"
    },
    "thresholds": [
      {
        "action": "a7ge3v0l",
        "limit": 3
      }
    ],
    "timeframe": 10
  },
  {
    "description": "3 requests per 2 seconds",
    "global": false,
    "exclude": [],
    "id": "f971e92459e2",
    "include": [],
    "key": [
      {
        "attrs": "ip"
      }
    ],
    "name": "Rate limit ban",
    "pairwith": {
      "self": "self"
    },
    "thresholds": [
      {
        "action": "ijcy5mwz",
        "limit": 3
      }
    ],
    "timeframe": 2
  },
  {
    "description": ":)",
    "global": false,
    "exclude": [],
    "id": "mlimitA",
    "include": [],
    "key": [
      {
        "headers": "h1"
      }
    ],
    "name": "Multilimit test A",
    "pairwith": {
      "self": "self"
    },
    "thresholds": [
      {
        "action": "default",
        "limit": 2
      }
    ],
    "timeframe": 5
  },
  {
    "description": ":)",
    "global": false,
    "exclude": [],
    "id": "mlimitB",
    "include": [],
    "key": [
      {
        "headers": "h2"
      }
    ],
    "name": "Multilimit test B",
    "pairwith": {
      "self": "self"
    },
    "thresholds": [
      {
        "action": "default",
        "limit": 3
      }
    ],
    "timeframe": 5
  },
  {
    "description": ":)",
    "global": false,
    "exclude": [],
    "id": "4d1d9d405fc9",
    "include": [],
    "key": [
      {
        "attrs": "ip"
      }
    ],
    "name": "Limit per method",
    "pairwith": {
      "attrs": "method"
    },
    "thresholds": [
      {
        "action": "default",
        "limit": 3
      }
    ],
    "timeframe": 5
  },
  {
    "description": ":)",
    "global": false,
    "exclude": [],
    "id": "4d1d9d405hdr",
    "include": [],
    "key": [
      {
        "attrs": "ip"
      }
    ],
    "name": "Limit per header",
    "pairwith": {
      "headers": "limitheader"
    },
    "thresholds": [
      {
        "action": "default",
        "limit": 2
      }
    ],
    "timeframe": 5
  },
  {
    "description": "Multiple thresholds. The last threshold to check that ban works even if it doesn't have the highest limit.",
    "global": false,
    "exclude": [],
    "id": "limitmultithreshold",
    "include": [],
    "key": [
      {
        "attrs": "ip"
      }
    ],
    "name": "First tag then ban",
    "pairwith": {
      "self": "self"
    },
    "thresholds": [
      {
        "action": "monitor",
        "limit": 2
      },
      {
        "action": "ijcy5mwz",
        "limit": 4
      },
      {
        "action": "default",
        "limit": 6
      }
    ],
    "timeframe": 4
  },
  {
    "description": "Test identical limits attached to the same location",
    "global": false,
    "exclude": [],
    "id": "samelocationA",
    "include": [],
    "key": [
      {
        "headers": "org"
      }
    ],
    "name": "Same location limit, A",
    "pairwith": {
      "self": "self"
    },
    "thresholds": [
      {
        "action": "monitor",
        "limit": 1
      }
    ],
    "timeframe": 20
  },
  {
    "description": "Test identical limits attached to the same location",
    "global": false,
    "exclude": [],
    "id": "samelocationB",
    "include": [],
    "key": [
      {
        "attrs": "ip"
      }
    ],
    "name": "Same location limit, B",
    "pairwith": {
      "self": "self"
    },
    "thresholds": [
      {
        "action": "default",
        "limit": 1
      }
    ],
    "timeframe": 20
  },
  {
    "description": "Limit per hostname",
    "global": false,
    "exclude": [],
    "id": "limithostname",
    "include": [],
    "key": [
      {
        "attrs": "securitypolicyid"
      }
    ],
    "name": "Limit Hostname",
    "pairwith": {
      "self": "self"
    },
    "thresholds": [
      {
        "action": "default",
        "limit": 1
      }
    ],
    "timeframe": 20
  },
  {
    "description": "Limit per url",
    "global": false,
    "exclude": [],
    "id": "limiturl",
    "include": [],
    "key": [
      {
        "attrs": "securitypolicyentryid"
      }
    ],
    "name": "Limit url",
    "pairwith": {
      "self": "self"
    },
    "thresholds": [
      {
        "action": "default",
        "limit": 1
      }
    ],
    "timeframe": 20
  },
  {
    "description": "The global limit",
    "exclude": [],
    "global": true,
    "id": "global_limit",
    "include": ["global-trigger"],
    "key": [
      {
        "attrs": "ip"
      }
    ],
    "name": "global limit",
    "pairwith": {
      "self": "self"
    },
    "thresholds": [
      {
        "action": "default",
        "limit": 2
      }
    ],
    "timeframe": 30
  }
]
